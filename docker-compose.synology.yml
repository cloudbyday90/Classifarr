version: '3.8'

# Docker Compose for Classifarr on Synology NAS
# Optimized for Synology's folder structure and DSM conventions

services:
  classifarr:
    image: ghcr.io/cloudbyday90/classifarr:latest
    container_name: classifarr
    ports:
      - "21324:21324"
    environment:
      # User/Group IDs - Default to common Synology admin user
      # Check your user ID with: id -u <username>
      - PUID=${PUID:-1026}
      - PGID=${PGID:-100}
      - UMASK=${UMASK:-022}
      # Application settings
      - NODE_ENV=production
      - TZ=${TZ:-UTC}
    volumes:
      # Main application data including embedded PostgreSQL
      # Adjust /volume1 to your specific volume if different
      - /volume1/docker/classifarr:/app/data
    restart: unless-stopped
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:21324/health" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
